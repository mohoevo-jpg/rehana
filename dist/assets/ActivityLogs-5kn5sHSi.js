import{r as p,l as h,h as w,i as _,g as C,c as n,b as t,j as L,G as N,k as V,e as x,O as S,a as T,v as D,d as M,F as O,m as j,Q as B,o as d,t as i,n as F}from"./index-DUS2SrFg.js";import{R as U}from"./refresh-cw-DZcBzaAy.js";import{f as H}from"./format-MhD4UfPn.js";import"./createLucideIcon-Dlap17QE.js";import"./en-US-dIBtKp69.js";const J={class:"space-y-6"},Q={class:"flex items-center justify-between"},R={class:"card p-4"},z={class:"flex flex-wrap gap-4"},A={class:"flex-1 min-w-[200px]"},E={class:"flex-1 min-w-[200px]"},G={class:"card overflow-hidden"},q={class:"overflow-x-auto"},I={class:"w-full"},K={class:"divide-y divide-gray-200 dark:divide-gray-700"},P={class:"py-3 px-4 text-gray-600 dark:text-gray-400 whitespace-nowrap",dir:"ltr"},W={class:"py-3 px-4"},X={class:"py-3 px-4 text-gray-900 dark:text-white font-medium"},Y={class:"py-3 px-4 text-gray-500 dark:text-gray-400 text-sm"},Z={class:"whitespace-pre-wrap font-mono text-xs"},$={key:0},lt={__name:"ActivityLogs",setup(tt){const r=p([]),l=p("all"),o=p(""),c=h("/",{path:"/socket.io"}),g=async()=>{try{const s=await B.get("/logs");r.value=s.data}catch(s){console.error("Failed to fetch logs:",s)}};w(()=>{g(),c.on("new-activity",s=>{r.value.unshift(s),r.value.length>500&&(r.value=r.value.slice(0,500))})}),_(()=>{c.disconnect()});const u=C(()=>r.value.filter(s=>{const e=l.value==="all"||s.type===l.value,a=o.value===""||s.message.toLowerCase().includes(o.value.toLowerCase())||JSON.stringify(s.details).toLowerCase().includes(o.value.toLowerCase());return e&&a})),m=s=>H(new Date(s),"yyyy-MM-dd HH:mm:ss"),f=s=>{if(!s||Object.keys(s).length===0)return"-";const e=Object.entries(s).reduce((a,[k,y])=>(y&&(a[k]=y),a),{});return JSON.stringify(e).replace(/[{"}]/g,"").replace(/,/g,", ")},v=s=>({order:"طلب",user:"مستخدم",product:"منتج",campaign:"حملة",settings:"إعدادات",system:"نظام"})[s]||s,b=s=>({order:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",user:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",product:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400",campaign:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",settings:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",system:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"})[s]||"bg-gray-100 text-gray-800";return(s,e)=>(d(),n("div",J,[t("div",Q,[e[3]||(e[3]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},"سجل النشاطات"),t("p",{class:"text-gray-500 dark:text-gray-400"},"سجل كامل لجميع العمليات في النظام")],-1)),t("button",{onClick:g,class:"btn-secondary"},[L(V(U),{class:"w-4 h-4 mr-2"}),e[2]||(e[2]=N(" تحديث ",-1))])]),t("div",R,[t("div",z,[t("div",A,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"تصفية حسب النوع",-1)),x(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>l.value=a),class:"input-field"},[...e[4]||(e[4]=[T('<option value="all">الكل</option><option value="order">الطلبات</option><option value="user">المستخدمين</option><option value="product">المنتجات</option><option value="campaign">الحملات</option><option value="settings">الإعدادات</option><option value="system">النظام</option>',7)])],512),[[S,l.value]])]),t("div",E,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"بحث",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o.value=a),type:"text",placeholder:"ابحث في السجل...",class:"input-field"},null,512),[[D,o.value]])])])]),t("div",G,[t("div",q,[t("table",I,[e[8]||(e[8]=t("thead",null,[t("tr",{class:"bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700"},[t("th",{class:"text-right py-3 px-4 font-medium text-gray-600 dark:text-gray-300"},"الوقت"),t("th",{class:"text-right py-3 px-4 font-medium text-gray-600 dark:text-gray-300"},"النوع"),t("th",{class:"text-right py-3 px-4 font-medium text-gray-600 dark:text-gray-300"},"الحدث"),t("th",{class:"text-right py-3 px-4 font-medium text-gray-600 dark:text-gray-300"},"التفاصيل")])],-1)),t("tbody",K,[(d(!0),n(O,null,j(u.value,a=>(d(),n("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800/50"},[t("td",P,i(m(a.timestamp)),1),t("td",W,[t("span",{class:F([b(a.type),"px-2 py-1 rounded-full text-xs font-medium"])},i(v(a.type)),3)]),t("td",X,i(a.message),1),t("td",Y,[t("pre",Z,i(f(a.details)),1)])]))),128)),u.value.length===0?(d(),n("tr",$,[...e[7]||(e[7]=[t("td",{colspan:"4",class:"py-8 text-center text-gray-500 dark:text-gray-400"}," لا توجد سجلات مطابقة ",-1)])])):M("",!0)])])])])]))}};export{lt as default};
