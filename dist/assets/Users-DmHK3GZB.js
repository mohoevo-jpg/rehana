import{s as I,r as b,c as a,b as e,d as h,F as y,m as v,k as w,t as n,e as d,v as g,G as M,O as k,H as _,o as r}from"./index-DUS2SrFg.js";import{u as S}from"./branches-C78i2SSd.js";const j={class:"space-y-6"},N={class:"flex justify-between items-center"},$={class:"bg-white shadow overflow-hidden sm:rounded-lg"},D={class:"min-w-full divide-y divide-gray-200"},E={class:"bg-white divide-y divide-gray-200"},F={class:"px-6 py-4 whitespace-nowrap"},T={class:"text-sm font-medium text-gray-900"},z={class:"px-6 py-4 whitespace-nowrap"},G={class:"text-sm text-gray-500"},H={class:"px-6 py-4 whitespace-nowrap"},L={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"},O={class:"px-6 py-4 whitespace-nowrap"},P={class:"text-sm text-gray-500"},q={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},A=["onClick"],J=["onClick"],K={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},Q={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},R={class:"inline-block align-bottom bg-white rounded-lg text-right overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},W={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},X={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},Y={class:"mt-4 space-y-4"},Z={class:"block text-sm font-medium text-gray-700"},ee={key:0,class:"text-xs text-gray-500 font-normal"},se=["placeholder"],te=["value"],le={class:"space-y-2 max-h-40 overflow-y-auto border p-2 rounded-md"},oe={class:"flex items-center"},ae=["id","value","disabled"],re=["for"],me={__name:"Users",setup(ne){const m=I(),u=S(),p=b(!1),i=b(!1),l=b({id:null,name:"",username:"",password:"",role:"cashier",branchId:"",permissions:[]}),U=[{key:"dashboard",label:"لوحة التحكم"},{key:"cashier",label:"الكاشير"},{key:"products",label:"المنتجات"},{key:"sales",label:"المبيعات"},{key:"stock",label:"المخزون"},{key:"reports",label:"التقارير"},{key:"chat",label:"الدردشة"},{key:"users",label:"المستخدمين"},{key:"branches",label:"الفروع"},{key:"settings",label:"الإعدادات"}],C=o=>{const s=u.getBranchById(o);return s?s.name:"غير محدد"},f=(o=null)=>{var s;o?(i.value=!0,l.value={...o,permissions:o.permissions||[],password:""}):(i.value=!1,l.value={id:null,name:"",username:"",password:"",role:"cashier",branchId:((s=u.branches[0])==null?void 0:s.id)||"",permissions:[]}),p.value=!0},c=()=>{p.value=!1},V=()=>{i.value?m.updateUser(l.value):m.addUser(l.value),c()},B=o=>{confirm("هل أنت متأكد من حذف هذا المستخدم؟")&&m.deleteUser(o)};return(o,s)=>(r(),a("div",j,[e("div",N,[s[8]||(s[8]=e("h2",{class:"text-2xl font-bold text-gray-900"},"إدارة المستخدمين",-1)),e("button",{onClick:s[0]||(s[0]=t=>f()),class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700"}," إضافة مستخدم جديد ")]),e("div",$,[e("table",D,[s[9]||(s[9]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," الاسم "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," اسم المستخدم "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," الدور "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," الفرع "),e("th",{scope:"col",class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"إجراءات")])])],-1)),e("tbody",E,[(r(!0),a(y,null,v(w(m).users,t=>(r(),a("tr",{key:t.id},[e("td",F,[e("div",T,n(t.name),1)]),e("td",z,[e("div",G,n(t.username),1)]),e("td",H,[e("span",L,n(t.role),1)]),e("td",O,[e("div",P,n(C(t.branchId)),1)]),e("td",q,[e("button",{onClick:x=>f(t),class:"text-primary-600 hover:text-primary-900 ml-4"},"تعديل",8,A),e("button",{onClick:x=>B(t.id),class:"text-red-600 hover:text-red-900"},"حذف",8,J)])]))),128))])])]),p.value?(r(),a("div",K,[e("div",Q,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:c}),s[18]||(s[18]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",R,[e("div",W,[e("h3",X,n(i.value?"تعديل مستخدم":"إضافة مستخدم جديد"),1),e("div",Y,[e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm font-medium text-gray-700"},"الاسم الكامل",-1)),d(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>l.value.name=t),type:"text",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"},null,512),[[g,l.value.name]])]),e("div",null,[s[11]||(s[11]=e("label",{class:"block text-sm font-medium text-gray-700"},"اسم المستخدم",-1)),d(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>l.value.username=t),type:"text",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"},null,512),[[g,l.value.username]])]),e("div",null,[e("label",Z,[s[12]||(s[12]=M(" كلمة المرور ",-1)),i.value?(r(),a("span",ee,"(اتركه فارغاً للإبقاء على كلمة المرور الحالية)")):h("",!0)]),d(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>l.value.password=t),type:"password",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",placeholder:i.value?"••••••":""},null,8,se),[[g,l.value.password]])]),e("div",null,[s[14]||(s[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"الدور",-1)),d(e("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>l.value.role=t),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"},[...s[13]||(s[13]=[e("option",{value:"admin"},"مدير",-1),e("option",{value:"manager"},"مشرف",-1),e("option",{value:"cashier"},"كاشير",-1)])],512),[[k,l.value.role]])]),e("div",null,[s[15]||(s[15]=e("label",{class:"block text-sm font-medium text-gray-700"},"الفرع",-1)),d(e("select",{"onUpdate:modelValue":s[5]||(s[5]=t=>l.value.branchId=t),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"},[(r(!0),a(y,null,v(w(u).branches,t=>(r(),a("option",{key:t.id,value:t.id},n(t.name),9,te))),128))],512),[[k,l.value.branchId]])]),e("div",null,[s[17]||(s[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"صلاحيات الوصول",-1)),e("div",le,[e("div",oe,[d(e("input",{type:"checkbox",id:"perm-all",value:"all","onUpdate:modelValue":s[6]||(s[6]=t=>l.value.permissions=t),class:"ml-2"},null,512),[[_,l.value.permissions]]),s[16]||(s[16]=e("label",{for:"perm-all",class:"text-sm text-gray-700 font-bold"},"جميع الصلاحيات",-1))]),(r(),a(y,null,v(U,t=>e("div",{key:t.key,class:"flex items-center"},[d(e("input",{type:"checkbox",id:"perm-"+t.key,value:t.key,"onUpdate:modelValue":s[7]||(s[7]=x=>l.value.permissions=x),class:"ml-2",disabled:l.value.permissions.includes("all")},null,8,ae),[[_,l.value.permissions]]),e("label",{for:"perm-"+t.key,class:"text-sm text-gray-700"},n(t.label),9,re)])),64))])])])]),e("div",{class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},[e("button",{onClick:V,type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm"}," حفظ "),e("button",{onClick:c,type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," إلغاء ")])])])])):h("",!0)]))}};export{me as default};
