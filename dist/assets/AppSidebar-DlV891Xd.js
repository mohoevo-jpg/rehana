import{_ as J}from"./logo-Cbfr3TE7.js";import{f as F,r as L,l as K,g as C,h as Q,i as W,c as x,o as y,b as r,d as I,j as b,k as M,t as k,F as Y,m as H,n as U,p as V,q as E,u as Z,s as ee,x as te,y as se,z,A as re}from"./index-DUS2SrFg.js";import{u as oe}from"./branches-C78i2SSd.js";import{c as w}from"./createLucideIcon-Dlap17QE.js";import{A as R,S as q,U as A}from"./users-Cpt_42Sy.js";import{P as T}from"./package-BC8sDszs.js";import{U as P}from"./user-GOvdep_U.js";import{S as G}from"./shopping-cart-DaBx0C0j.js";import{t as f,c as ne,g as N,a as ae,e as ce,m as X,b as O}from"./en-US-dIBtKp69.js";import{a as ie}from"./ar-YW_Uz9wj.js";import{G as le}from"./globe-DTUJ4iLc.js";import{F as ue}from"./file-text-C5kbrT4y.js";import{M as j}from"./message-circle-Db_nYIl_.js";/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=w("BarChart3Icon",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=w("BellOffIcon",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=w("BellIcon",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=w("BuildingIcon",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=w("LayoutDashboardIcon",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=w("LogOutIcon",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-vue-next v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=w("MegaphoneIcon",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);function $(o,t){const e=f(o),a=f(t),s=e.getTime()-a.getTime();return s<0?-1:s>0?1:s}function xe(o){return ne(o,Date.now())}function ve(o,t){const e=f(o),a=f(t),s=e.getFullYear()-a.getFullYear(),h=e.getMonth()-a.getMonth();return s*12+h}function _e(o){return t=>{const a=(o?Math[o]:Math.trunc)(t);return a===0?0:a}}function ke(o,t){return+f(o)-+f(t)}function be(o){const t=f(o);return t.setHours(23,59,59,999),t}function we(o){const t=f(o),e=t.getMonth();return t.setFullYear(t.getFullYear(),e+1,0),t.setHours(23,59,59,999),t}function Me(o){const t=f(o);return+be(t)==+we(t)}function De(o,t){const e=f(o),a=f(t),s=$(e,a),h=Math.abs(ve(e,a));let d;if(h<1)d=0;else{e.getMonth()===1&&e.getDate()>27&&e.setDate(30),e.setMonth(e.getMonth()-s*h);let n=$(e,a)===-s;Me(f(o))&&h===1&&$(o,a)===1&&(n=!1),d=s*(h-Number(n))}return d===0?0:d}function Se(o,t,e){const a=ke(o,t)/1e3;return _e(e==null?void 0:e.roundingMethod)(a)}function Ce(o,t,e){const a=ae(),s=(e==null?void 0:e.locale)??a.locale??ce,h=2520,d=$(o,t);if(isNaN(d))throw new RangeError("Invalid time value");const n=Object.assign({},e,{addSuffix:e==null?void 0:e.addSuffix,comparison:d});let v,_;d>0?(v=f(t),_=f(o)):(v=f(o),_=f(t));const g=Se(_,v),D=(N(_)-N(v))/1e3,u=Math.round((g-D)/60);let i;if(u<2)return e!=null&&e.includeSeconds?g<5?s.formatDistance("lessThanXSeconds",5,n):g<10?s.formatDistance("lessThanXSeconds",10,n):g<20?s.formatDistance("lessThanXSeconds",20,n):g<40?s.formatDistance("halfAMinute",0,n):g<60?s.formatDistance("lessThanXMinutes",1,n):s.formatDistance("xMinutes",1,n):u===0?s.formatDistance("lessThanXMinutes",1,n):s.formatDistance("xMinutes",u,n);if(u<45)return s.formatDistance("xMinutes",u,n);if(u<90)return s.formatDistance("aboutXHours",1,n);if(u<X){const l=Math.round(u/60);return s.formatDistance("aboutXHours",l,n)}else{if(u<h)return s.formatDistance("xDays",1,n);if(u<O){const l=Math.round(u/X);return s.formatDistance("xDays",l,n)}else if(u<O*2)return i=Math.round(u/O),s.formatDistance("aboutXMonths",i,n)}if(i=De(_,v),i<12){const l=Math.round(u/O);return s.formatDistance("xMonths",l,n)}else{const l=i%12,c=Math.trunc(i/12);return l<3?s.formatDistance("aboutXYears",c,n):l<9?s.formatDistance("overXYears",c,n):s.formatDistance("almostXYears",c+1,n)}}function Ie(o,t){return Ce(o,xe(o),t)}const Oe={key:0,class:"absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center border-2 border-white"},$e={key:0,class:"absolute left-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-100 z-50 overflow-hidden"},Be={class:"p-3 border-b border-gray-100 flex justify-between items-center"},Le={class:"max-h-96 overflow-y-auto"},Re={key:0,class:"p-8 text-center text-gray-500"},Te=["onClick"],Ue={class:"flex gap-3"},ze={class:"flex-1 min-w-0"},Ae={class:"text-sm font-medium text-gray-900 truncate"},Ne={class:"text-xs text-gray-500 mt-1"},Xe={__name:"NotificationsDropdown",setup(o){const t=F(),e=L(!1),a=L([]),s=L(null),h=K("/",{path:"/socket.io"}),d=C(()=>a.value.filter(c=>!c.read).length),n=()=>{e.value=!e.value},v=c=>{s.value&&!s.value.contains(c.target)&&(e.value=!1)},_=()=>{a.value.forEach(c=>c.read=!0)},g=c=>{c.read=!0,t.push("/activity-logs"),e.value=!1},D=()=>{t.push("/activity-logs"),e.value=!1},u=c=>Ie(new Date(c),{addSuffix:!0,locale:ie}),i=c=>({order:G,user:P,product:T,campaign:pe,settings:q,system:R})[c]||R,l=c=>({order:"bg-blue-100 text-blue-600",user:"bg-green-100 text-green-600",product:"bg-purple-100 text-purple-600",campaign:"bg-orange-100 text-orange-600",settings:"bg-gray-200 text-gray-600",system:"bg-red-100 text-red-600"})[c]||"bg-gray-100 text-gray-600";return Q(()=>{document.addEventListener("click",v),h.on("new-activity",c=>{a.value.unshift({...c,read:!1}),["order","system"].includes(c.type),a.value.length>20&&(a.value=a.value.slice(0,20))})}),W(()=>{document.removeEventListener("click",v),h.disconnect()}),(c,p)=>(y(),x("div",{class:"relative",ref_key:"dropdownRef",ref:s},[r("button",{onClick:n,class:"relative p-2 text-gray-600 hover:bg-gray-100 rounded-full transition-colors focus:outline-none"},[b(M(he),{class:"w-6 h-6"}),d.value>0?(y(),x("span",Oe,k(d.value>9?"9+":d.value),1)):I("",!0)]),e.value?(y(),x("div",$e,[r("div",Be,[p[0]||(p[0]=r("h3",{class:"font-semibold text-gray-800"},"الإشعارات",-1)),d.value>0?(y(),x("button",{key:0,onClick:_,class:"text-xs text-primary-600 hover:text-primary-800 font-medium"}," تحديد الكل كمقروء ")):I("",!0)]),r("div",Le,[a.value.length===0?(y(),x("div",Re,[b(M(fe),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),p[1]||(p[1]=r("p",{class:"text-sm"},"لا توجد إشعارات جديدة",-1))])):I("",!0),(y(!0),x(Y,null,H(a.value,m=>(y(),x("div",{key:m.id,class:U(["p-3 border-b border-gray-50 hover:bg-gray-50 transition-colors cursor-pointer",{"bg-blue-50/50":!m.read}]),onClick:B=>g(m)},[r("div",Ue,[r("div",{class:U([l(m.type),"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0"])},[(y(),V(E(i(m.type)),{class:"w-4 h-4"}))],2),r("div",ze,[r("p",Ae,k(m.message),1),r("p",Ne,k(u(m.timestamp)),1)])])],10,Te))),128))]),r("div",{class:"p-2 border-t border-gray-100 bg-gray-50 text-center"},[r("button",{onClick:D,class:"text-sm text-primary-600 hover:text-primary-800 font-medium w-full py-1"}," عرض كل النشاطات ")])])):I("",!0)],512))}},je={class:"flex h-screen bg-gray-100 overflow-hidden"},Fe={class:"w-64 bg-white shadow-md flex flex-col z-10"},Ye={class:"flex-1 overflow-y-auto py-4"},He={class:"space-y-1 px-2"},Ve={class:"flex items-center"},Ee={key:0,class:"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full"},qe={class:"p-4 border-t"},Pe={class:"flex-1 overflow-hidden flex flex-col relative"},Ge={class:"bg-white shadow-sm p-4 flex justify-between items-center z-10"},Je={class:"text-xl font-semibold text-gray-800"},Ke={class:"flex items-center space-x-4 space-x-reverse"},Qe={class:"flex items-center"},We={class:"flex flex-col items-end ml-3"},Ze={class:"text-sm font-medium text-gray-800"},et={class:"text-xs text-gray-500"},tt={class:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center text-primary-600"},st={class:"flex-1 overflow-auto p-6"},gt={__name:"AppSidebar",setup(o){const t=Z(),e=ee(),a=oe(),s=te(),h=F(),d=se(),n=C(()=>{var i;if((i=t.currentUser)!=null&&i.id){const l=e.getUserById(t.currentUser.id);if(l)return l}return t.currentUser}),v=C(()=>!n.value||!n.value.branchId?null:a.branches.find(i=>i.id===n.value.branchId)),_=C(()=>d.name?d.name.toLowerCase():"dashboard"),g=[{key:"dashboard",route:"Dashboard",icon:ye},{key:"cashier",route:"Cashier",icon:G},{key:"online_orders",route:"OnlineOrders",icon:le},{key:"products",route:"Products",icon:T},{key:"sales",route:"Sales",icon:de},{key:"stock",route:"Stock",icon:T},{key:"reports",route:"Reports",icon:ue},{key:"activity_logs",route:"ActivityLogs",icon:R},{key:"chat",route:"Chat",icon:j},{key:"users",route:"Users",icon:A},{key:"customers",route:"Customers",icon:A},{key:"complaints",route:"Complaints",icon:j},{key:"branches",route:"Branches",icon:me},{key:"settings",route:"Settings",icon:q}],D=C(()=>{var c,p;const i=((c=n.value)==null?void 0:c.permissions)||[],l=(p=n.value)==null?void 0:p.role;return l==="admin"||i.includes("all")?g:g.filter(m=>l==="cashier"&&m.key==="complaints"?!0:i.includes(m.key))}),u=()=>{t.logout(),h.push("/login")};return(i,l)=>{var m,B;const c=z("router-link"),p=z("router-view");return y(),x("div",je,[r("aside",Fe,[l[0]||(l[0]=r("div",{class:"p-4 border-b flex items-center justify-center py-8"},[r("img",{src:J,alt:"Rehana",class:"w-48 h-auto object-contain transition-all duration-300 hover:scale-105"})],-1)),r("nav",Ye,[r("ul",He,[(y(!0),x(Y,null,H(D.value,S=>(y(),x("li",{key:S.route},[b(c,{to:{name:S.route},class:"flex items-center justify-between px-4 py-3 text-gray-600 rounded-lg hover:bg-primary-50 hover:text-primary-600 transition-colors","active-class":"bg-primary-50 text-primary-600 font-medium"},{default:re(()=>[r("div",Ve,[(y(),V(E(S.icon),{class:"w-5 h-5 ml-3"})),r("span",null,k(i.$t(`menu.${S.key}`)),1)]),S.key==="online_orders"&&M(s).newOrdersCount>0?(y(),x("span",Ee,k(M(s).newOrdersCount),1)):I("",!0)]),_:2},1032,["to"])]))),128))])]),r("div",qe,[r("button",{onClick:u,class:"flex items-center w-full px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[b(M(ge),{class:"w-5 h-5 ml-3"}),r("span",null,k(i.$t("menu.logout")),1)])])]),r("main",Pe,[r("header",Ge,[r("h2",Je,k(i.$t(`menu.${_.value}`)),1),r("div",Ke,[b(Xe),r("div",Qe,[r("div",We,[r("span",Ze,k((m=n.value)==null?void 0:m.name),1),r("span",et,k(((B=v.value)==null?void 0:B.name)||"الفرع الرئيسي"),1)]),r("div",tt,[b(M(P),{class:"w-5 h-5"})])])])]),r("div",st,[b(p)])])])}}};export{gt as default};
